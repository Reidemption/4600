(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{3874:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-account",function(){return n(7446)}])},2804:function(e,r,n){"use strict";n.d(r,{K:function(){return i}});var t=n(4480);let i=(0,t.cn)({key:"userState",default:null})},165:function(e,r,n){"use strict";var t=n(5893),i=n(204),l=n(6684),a=n(8911),s=n(5034),o=n(9222),d=n(3247),c=n(1618),u=n(7294);let f=e=>{let{request:r,acceptRequest:n,rejectRequest:f,loading:h}=e,[m,x]=u.useState(null),v=async()=>{let e=await (0,d.QT)((0,d.JU)(c.RZ,"users",null==r?void 0:r.friend_id));if(e.data()){var n,t;x((null===(n=null==e?void 0:e.data())||void 0===n?void 0:n.displayName)||(null===(t=null==e?void 0:e.data())||void 0===t?void 0:t.email))}};return(0,u.useEffect)(()=>{(async function(){await v()})()},[]),(0,t.jsxs)(i.k,{border:"1px",borderColor:"gray",borderRadius:"md",p:4,mb:4,w:"full",alignItems:"center",justifyContent:"space-between",children:[(0,t.jsxs)(l.K,{direction:"column",children:[m&&(0,t.jsx)(a.x,{fontWeight:"bold",children:m}),(0,t.jsx)(a.x,{children:r.status})]}),(0,t.jsx)(s.L,{}),(0,t.jsxs)(l.K,{direction:"row",children:["accepted"!=r.status&&(0,t.jsx)(o.z,{colorScheme:"green",isLoading:h,onClick:()=>{n(r)},children:"Accept"}),"rejected"!=r.status&&(0,t.jsx)(o.z,{colorScheme:"red",isLoading:h,onClick:()=>{f(r)},children:"Reject"})]})]})};r.Z=f},7446:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return B}});var t=n(5893),i=n(7294),l=n(7754),a=n(6684),s=n(204),o=n(8911),d=n(9222),c=n(6383),u=n(1163),[f,h]=(0,n(5227).k)({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"}),m=n(9513);function x(e){let[r,n]=e.split(" ");return r&&n?`${r.charAt(0)}${n.charAt(0)}`:r.charAt(0)}function v(e){let{name:r,getInitials:n,...i}=e,l=h();return(0,t.jsx)(m.m.div,{role:"img","aria-label":r,...i,__css:l.label,children:r?null==n?void 0:n(r):null})}v.displayName="AvatarName";var p=e=>(0,t.jsxs)(m.m.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",...e,children:[(0,t.jsx)("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),(0,t.jsx)("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]}),j=n(5721);function g(e){let{src:r,srcSet:n,onError:l,onLoad:a,getInitials:s,name:o,borderRadius:d,loading:c,iconLabel:u,icon:f=(0,t.jsx)(p,{}),ignoreFallback:h,referrerPolicy:x}=e,g=(0,j.d)({src:r,onError:l,ignoreFallback:h});return r&&"loaded"===g?(0,t.jsx)(m.m.img,{src:r,srcSet:n,alt:o,onLoad:a,referrerPolicy:x,className:"chakra-avatar__img",loading:c,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:d}}):o?(0,t.jsx)(v,{className:"chakra-avatar__initials",getInitials:s,name:o}):(0,i.cloneElement)(f,{role:"img","aria-label":u})}g.displayName="AvatarImage";var y=n(5059),_=n(4662),b=n(3179),C=n(5432),N={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},w=(0,y.G)((e,r)=>{let n=(0,_.jC)("Avatar",e),[l,a]=(0,i.useState)(!1),{src:s,srcSet:o,name:d,showBorder:c,borderRadius:u="full",onError:h,onLoad:v,getInitials:j=x,icon:y=(0,t.jsx)(p,{}),iconLabel:w=" avatar",loading:S,children:k,borderColor:E,ignoreFallback:U,...z}=(0,b.Lr)(e),A={borderRadius:u,borderWidth:c?"2px":void 0,...N,...n.container};return E&&(A.borderColor=E),(0,t.jsx)(m.m.span,{ref:r,...z,className:(0,C.cx)("chakra-avatar",e.className),"data-loaded":(0,C.PB)(l),__css:A,children:(0,t.jsxs)(f,{value:n,children:[(0,t.jsx)(g,{src:s,srcSet:o,loading:S,onLoad:(0,C.v0)(v,()=>{a(!0)}),onError:h,getInitials:j,name:d,borderRadius:u,icon:y,iconLabel:w,ignoreFallback:U}),k]})})});w.displayName="Avatar";var S=n(4480),k=n(2804),E=n(6877),U=n(7335),z=n(9154),A=n(2752),I=n(1963),L=n(1948),R=n(4504),q=n(5819),K=n(3793),Z=n(8267),P=n(5370),W=n(8129),T=n(7018),J=n(5034),O=n(8193);let F=()=>(0,t.jsx)(E.J,{as:O.$iz,boxSize:4}),M=e=>{let{handleEditUser:r,user:n}=e,l=(0,c.v0)(),{isOpen:u,onOpen:f,onClose:h}=(0,U.q)(),[m,x]=(0,i.useState)({email:n.email,displayName:n.displayName}),[v,p]=(0,i.useState)(!1),[j,g]=(0,i.useState)(""),y=()=>{x({...n}),h()},_=e=>{x({...m,[e.target.name]:e.target.value})},b=e=>{e.preventDefault(),r(m)},C=()=>{(0,c.LS)(l,n.email).then(()=>{p(!0)}).catch(e=>{let r=e.code,n=e.message;g("".concat(r,", ").concat(n))})};return(0,t.jsxs)(s.k,{children:[(0,t.jsx)(z.h,{"aria-label":"Edit chore",size:"xs",icon:(0,t.jsx)(F,{}),onClick:f}),(0,t.jsxs)(A.u_,{onClose:h,isOpen:u,children:[(0,t.jsx)(I.Z,{}),(0,t.jsx)("form",{onSubmit:b,children:(0,t.jsxs)(L.h,{maxW:"40rem",children:[(0,t.jsx)(R.x,{children:"Edit Profile Info"}),(0,t.jsx)(q.o,{}),(0,t.jsx)(K.f,{children:(0,t.jsxs)(a.K,{direction:"column",spacing:2,children:[(0,t.jsxs)(Z.NI,{isRequired:!0,children:[(0,t.jsx)(P.l,{mb:0,children:"Email:"}),(0,t.jsx)(W.I,{value:null==m?void 0:m.email,id:"email",name:"email",onChange:_})]}),(0,t.jsxs)(Z.NI,{children:[(0,t.jsx)(P.l,{mb:0,children:"Username:"}),(0,t.jsx)(W.I,{id:"displayName",name:"displayName",onChange:_,value:m.displayName})]}),!v&&(0,t.jsx)(o.x,{onClick:C,as:"i",style:{cursor:"pointer"},color:"blue.500",children:"Click Here to Update Password"}),v&&(0,t.jsx)(o.x,{color:"green.500",children:"Check your email!"}),v&&""!=j&&(0,t.jsx)(o.x,{color:"green.500",children:j})]})}),(0,t.jsxs)(T.m,{children:[(0,t.jsx)(d.z,{colorScheme:"purple",type:"submit",onClick:()=>{r(m),h()},children:"Update User Info"}),(0,t.jsx)(J.L,{}),(0,t.jsx)(d.z,{onClick:y,children:"Close"})]})]})})]})]})};var G=n(165),V=n(3247),X=n(1618);let $=()=>{let[e,r]=i.useState(!0),[n,f]=(0,S.FV)(k.K),[h,m]=i.useState(null),[x,v]=i.useState(!1),p=(0,u.useRouter)(),j=(0,c.v0)(),[g,y]=i.useState(""),[_,b]=i.useState([]),[C,N]=i.useState(!1),[E,U]=i.useState(!1),z=async()=>{(0,c.Aj)(j,async e=>{try{if(!e){p.push("/");return}let{uid:n,email:t,displayName:i}=e;console.log(e),f({uid:n,email:t,displayName:i}),m(e),console.log("currentUser",h),r(!1)}catch(e){console.error("myAccount error:",e)}})};(0,i.useEffect)(()=>{!async function(){await z()}()},[]);let A=()=>{console.log("logout"),(0,c.w7)(j),p.push("/")},I=()=>{console.log("update profile picture")},L=async()=>{console.log("getFriendships"),U(!0);try{var e;if(!n)throw Error("User error. Try again later.");m(n);let r=(0,V.JU)(X.RZ,"friends",n.uid),t=await (0,V.QT)(r);if(!t.exists())throw Error("Possibility of no friends.");let i=null===(e=t.data())||void 0===e?void 0:e.friends;console.log("requests",i),console.log("requests",i.filter(e=>"pending"!==e.status)),b(i.filter(e=>"pending"!==e.status))}catch(e){console.log("Error detected in getFriendships",e)}U(!1)},R=e=>{if(""===e.email||!e.email.includes("@")){y("Valid email is required");return}if(e.displayName===h.displayName||e.displayName===(null==n?void 0:n.displayName))return;let r=(0,c.v0)();r.currentUser&&((e.email!=(null==n?void 0:n.email)||e.email!=h.email)&&(0,c.s)(r.currentUser,e.email).then(()=>{m(r.currentUser);let{uid:e,email:n,displayName:t}=r.currentUser;f({uid:e,email:n,displayName:t})}).catch(e=>{console.log(e)}),(0,c.ck)(r.currentUser,{displayName:e.displayName}).then(()=>{m(r.currentUser);let{uid:e,email:n,displayName:t}=r.currentUser;f({uid:e,email:n,displayName:t}),console.log("updated!")}).catch(e=>{console.log(e)}))};_.length;let q=async e=>{N(!0),await Z(e,"accepted"),await L(),N(!1)},K=async e=>{N(!0),await Z(e,"rejected"),await L(),N(!1)},Z=async(e,r)=>{try{await (0,V.i3)(X.RZ,async n=>{var t,i,l,a,s,o;let d={friend_id:e.friend_id,status:r,sender_id:e.sender_id},c={friend_id:h.uid,status:r,sender_id:e.sender_id},u=(0,V.JU)(X.RZ,"friends",h.uid),f=await n.get(u),m=(0,V.JU)(X.RZ,"friends",e.sender_id),x=await n.get(m);if(!f.exists()||!(null===(t=f.data())||void 0===t?void 0:t.friends))throw console.log("Error finding document"),Error("error finding friend's document");let v=null===(i=f.data())||void 0===i?void 0:i.friends.findIndex(r=>r.friend_id===e.friend_id&&r.sender_id===e.sender_id&&r.status===e.status);if(-1===v)throw Error("error finding index of friend's document");let p=[...null===(l=f.data())||void 0===l?void 0:l.friends];if(p[v]=d,n.update(u,{friends:[...p]}),!x.exists()||!(null===(a=x.data())||void 0===a?void 0:a.friends))throw Error("error finding friend request");let j=null===(s=x.data())||void 0===s?void 0:s.friends.findIndex(r=>h.uid===r.friend_id&&r.sender_id===e.sender_id&&r.status===e.status);if(-1===j)throw Error("error finding friend request");let g=[...null===(o=x.data())||void 0===o?void 0:o.friends];g[j]=c,n.update(m,{friends:[...g]})})}catch(e){console.log(e)}};return(0,t.jsx)(l.M,{h:"100vh",children:(0,t.jsxs)(a.K,{direction:"column",children:[(0,t.jsx)(s.k,{border:"2px",borderColor:"black",p:"2",children:(0,t.jsxs)(a.K,{direction:"row",mb:"4",mt:"2",children:[(0,t.jsxs)(a.K,{direction:"column",alignItems:"center",children:[(0,t.jsx)(w,{size:"md",name:"User Avatar",src:"/avatar_placeholder.jpg",onClick:()=>I()}),(0,t.jsx)(o.x,{align:"center",as:"i",style:{cursor:"pointer"},color:"blue.500",w:"10vh",children:"Update Profile Picture"})]}),(0,t.jsxs)(a.K,{direction:"column",px:"3",children:[!(null==h?void 0:h.displayName)&&(0,t.jsx)(o.x,{fontSize:"xl",fontWeight:"bold",children:"No Username Set"}),(null==h?void 0:h.displayName)&&(0,t.jsx)(o.x,{fontSize:"xl",fontWeight:"bold",children:null==h?void 0:h.displayName}),(0,t.jsx)(o.x,{fontSize:"xl",fontWeight:"bold",children:null==n?void 0:n.email}),(null==h?void 0:h.phoneNumber)&&(0,t.jsx)(o.x,{fontSize:"xl",fontWeight:"bold",children:null==h?void 0:h.phoneNumber}),(0,t.jsx)(d.z,{colorScheme:"purple",onClick:A,children:"Log out"})]}),!e&&(0,t.jsx)(M,{user:h,handleEditUser:R})]})}),(0,t.jsx)(s.k,{align:"center",justify:"center",children:(0,t.jsx)(d.z,{colorScheme:"purple",w:"50%",outlineColor:"black",isLoading:E,onClick:()=>L(),children:"View All Relationships"})}),_.map((e,r)=>(0,t.jsx)(G.Z,{request:e,rejectRequest:K,acceptRequest:q,loading:C,uid:null==n?void 0:n.uid},r))]})})};var B=$},5721:function(e,r,n){"use strict";n.d(r,{d:function(){return l},z:function(){return a}});var t=n(6245),i=n(7294);function l(e){let{loading:r,src:n,srcSet:l,onLoad:a,onError:s,crossOrigin:o,sizes:d,ignoreFallback:c}=e,[u,f]=(0,i.useState)("pending");(0,i.useEffect)(()=>{f(n?"loading":"pending")},[n]);let h=(0,i.useRef)(),m=(0,i.useCallback)(()=>{if(!n)return;x();let e=new Image;e.src=n,o&&(e.crossOrigin=o),l&&(e.srcset=l),d&&(e.sizes=d),r&&(e.loading=r),e.onload=e=>{x(),f("loaded"),null==a||a(e)},e.onerror=e=>{x(),f("failed"),null==s||s(e)},h.current=e},[n,o,l,d,a,s,r]),x=()=>{h.current&&(h.current.onload=null,h.current.onerror=null,h.current=null)};return(0,t.G)(()=>{if(!c)return"loading"===u&&m(),()=>{x()}},[u,m,c]),c?"loaded":u}var a=(e,r)=>"loaded"!==e&&"beforeLoadOrError"===r||"failed"===e&&"onError"===r},7754:function(e,r,n){"use strict";n.d(r,{M:function(){return a}});var t=n(9513),i=n(5059),l=n(5893),a=(0,t.m)("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});a.displayName="Center";var s={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};(0,i.G)(function(e,r){let{axis:n="both",...i}=e;return(0,l.jsx)(t.m.div,{ref:r,__css:s[n],...i,position:"absolute"})})}},function(e){e.O(0,[617,774,888,179],function(){return e(e.s=3874)}),_N_E=e.O()}]);